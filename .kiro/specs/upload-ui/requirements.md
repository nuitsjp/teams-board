# 要件ドキュメント

## はじめに

本仕様は、学習ダッシュボードにおけるTeams出席レポートCSVのアップロード機能UIを改善・拡張するための要件を定義する。現在のAdminPanelは単一ファイルのアップロード・プレビュー・保存に対応しているが、複数ファイルの一括処理、ユーザーへのフィードバック強化、バリデーション表示、操作性の向上が求められている。

## 要件

### 要件 1: 複数ファイル一括アップロード
**目的:** 管理者として、複数のCSVファイルをまとめてアップロードしたい。これにより、複数回の勉強会データを効率的に投入できる。

#### 受入基準
1. When 管理者が複数のCSVファイルをドロップゾーンにドラッグ&ドロップした場合, the AdminPanel shall すべてのファイルをキューに追加し、ファイル一覧を表示する
2. When 管理者がファイル選択ダイアログで複数ファイルを選択した場合, the AdminPanel shall `multiple`属性により全ファイルを受け付け、キューに追加する
3. While ファイルキューにファイルが存在する間, the AdminPanel shall 各ファイルの名前・サイズ・処理状態（未処理/処理中/成功/失敗）を一覧表示する
4. When 管理者がキュー内の個別ファイルの削除ボタンをクリックした場合, the AdminPanel shall 当該ファイルをキューから除外し、一覧を更新する

### 要件 2: アップロード前プレビューの拡充
**目的:** 管理者として、保存前にアップロード内容を詳細に確認したい。これにより、誤ったデータの投入を防止できる。

#### 受入基準
1. When CSVファイルの解析が完了した場合, the AdminPanel shall 勉強会名・開催日・参加者数・合計学習時間のサマリーカードを表示する
2. When 管理者がサマリーカードをクリックした場合, the AdminPanel shall 参加者ごとの名前と学習時間の詳細テーブルを展開表示する
3. If CSVファイルの内容に既存セッションとのID重複がある場合, the AdminPanel shall 重複セッションを警告アイコン付きでハイライト表示し、上書き確認を求める
4. When 複数ファイルがキューに存在する場合, the AdminPanel shall 各ファイルごとに独立したプレビューセクションを表示する

### 要件 3: バリデーションとエラーフィードバック
**目的:** 管理者として、無効なファイルや不正なデータについて明確なフィードバックを得たい。これにより、問題の特定と対処が容易になる。

#### 受入基準
1. When CSV以外の拡張子のファイルがアップロードされた場合, the AdminPanel shall 「CSVファイルのみ対応しています」というエラーメッセージを表示し、当該ファイルを拒否する
2. If CSVの解析中にパースエラーが発生した場合, the AdminPanel shall エラーの詳細（行番号・内容）を表示し、他のファイルの処理は継続する
3. If ファイルサイズが上限（10MB）を超過した場合, the AdminPanel shall ファイルサイズ制限超過のエラーメッセージを表示する
4. The AdminPanel shall すべてのエラーメッセージを赤色の警告スタイルで、成功メッセージを緑色の確認スタイルで表示する

### 要件 4: 保存処理の進捗表示
**目的:** 管理者として、保存処理の進捗をリアルタイムで把握したい。これにより、処理状況の不透明さによる不安を解消できる。

#### 受入基準
1. When 「一括保存」ボタンがクリックされた場合, the AdminPanel shall 各ファイルの保存処理を順次実行し、プログレスバーで全体の進捗を表示する
2. While 保存処理が進行中の間, the AdminPanel shall 処理中のファイル名と「保存中...」のステータスを表示し、保存ボタンを無効化する
3. When 個別ファイルの保存が完了した場合, the AdminPanel shall 当該ファイルのステータスを成功（✓）または失敗（✗）に更新する
4. If 一部のファイル保存が失敗した場合, the AdminPanel shall 失敗したファイルのみを対象としたリトライボタンを表示する

### 要件 5: ドラッグ&ドロップUIの改善
**目的:** 管理者として、直感的で視覚的に優れたアップロード体験を得たい。これにより、操作ミスを減らし効率を向上させる。

#### 受入基準
1. While ファイルがブラウザウィンドウ上にドラッグされている間, the AdminPanel shall ドロップゾーンをハイライトし、「ここにドロップ」のガイドテキストを表示する
2. When ドロップゾーンにファイルがドロップされた場合, the AdminPanel shall ドロップアニメーション（フェードイン等）で受付を視覚的にフィードバックする
3. The AdminPanel shall ドロップゾーンにファイルアイコンとアップロード手順の簡易説明を常時表示する
4. While キューにファイルが存在する間, the AdminPanel shall ドロップゾーンを縮小表示し、「さらにファイルを追加」のテキストに切り替える
